from flask import Flask, request, jsonify, make_response
from flask_sqlalchemy import SQLAlchemy
from dotenv import load_dotenv
import os

# charger le .env
load_dotenv()

# cr√©er le serveur d'api
app = Flask(__name__)

# config db
app.config['SECRET_KEY'] ='Th1s1ss3cr3t'
app.config['SQLALCHEMY_DATABASE_URI'] = f"postgresql://{os.environ.get('POSTGRES_USER')}:{os.environ.get('POSTGRES_PASS')}@{os.environ.get('POSTGRES_HOST')}/{os.environ.get('POSTGRES_DB')}"
app.config['SQLALCHEMY_TRACK_MODIFICATIONS'] = True

# db object
db = SQLAlchemy(app)

#model user
class User(db.Model):

    __tablename__ = 'auth_user'

    id = db.Column('id', db.Integer, primary_key=True)
    username = db.Column('username', db.String(100))
    password = db.Column('password', db.String(255))


# test api
@app.route('/test', methods=['GET'])
def test_user():
    user = User.query.get(1)
    return jsonify(
        username=user.username,
        password=user.password
    )


# run app
if __name__ == "__main__":
    app.run("localhost", 8000)
